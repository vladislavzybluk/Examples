WITH users_cnt AS (
    SELECT session_start::date AS session_date,
           COUNT(DISTINCT user_id) AS users_cnt
    FROM online_store.sessions
    GROUP BY session_date
)
SELECT *,
       LAG(users_cnt, 7) OVER (ORDER BY session_date) AS previous_weekday_users_cnt,
       ((users_cnt::numeric / LAG(users_cnt, 7) OVER (ORDER BY session_date)) - 1) * 100 AS user_growth
FROM users_cnt; 
